# 图片描述生成（诗歌）

## 目录
1. [项目简介](#项目简介)
2. [难点分析](#难点分析)
3. [模型结构](#模型结构)
4. [所用数据集](#所用数据集)
5. [结果](#结果)
6. [参考](#参考)
7. [使用说明](#使用说明)

## 项目简介
&emsp;&emsp;从图像中自动生成自然语言已经引起广泛关注，本项目更进一步来研究由**图像自动生成诗歌**（多行）创作。不同于普通的图片描述，诗歌描述可能不那么注重于描述图片所代表的事实本身，而是倾向于从图像中的物体、场景和情感中捕捉更深层次的意义和诗意符号（如从猎鹰中捕捉骑士，从进食中捕捉狩猎和战斗，从站立中捕捉等待）。本项目通过使用策略梯度进行对抗训练将任务进一步拆解，最终虽然再韵律等传统的诗歌技巧等方面仍不成熟，但仍然具有一定的是个结构和风格。   

## 难点分析
1. **多模态处理**：与由主题生成诗歌相比，该任务是一个跨模态任务。一个直观的想法是由图像提取主题再生成诗歌，但是这样会造成信息丢失。
2. **任务主观性**：与caption相比，该任务是一个更加主观的任务，因为一张图像可能对应多种诗歌，而caption更侧重描述image中的客观事实。
3. **格式要求**：诗歌的格式和风格与自然语言不同。本文生成的是自由诗（English free verse），对韵律等无要求。
4. 
## 模型结构

![1](https://github.com/user-attachments/assets/c25f6cec-5f9a-48d3-ace0-766fce09da18)

 **（1)深度耦合视觉-诗歌嵌入模型**：用于从图像中学习诗歌表征。
 
 **（2)策略梯度优化的多对抗训练过程**：基于RNN的生成器作为代理，两个判别网络为策略梯度提供奖励。



## 所用数据集
1. **Multi-Modal Poem dataset (MultiM-Poem)**：由图像和人工标注的诗句组成
![2(1)](https://github.com/user-attachments/assets/0976ab2f-1079-4d2e-83ea-0d099e4884f1)

2. **Uni-Modal Poem dataset (UniM-Poem)**:最大的诗句语料库
![2(2)](https://github.com/user-attachments/assets/b6530648-0490-4e58-9818-a367dd729912)

3. **MultiM-Poem (Ex)**：通过训练好的嵌入模型，对MultiM-Poem通过相似度扩展并去除冗余而来

## 结果

### 1.**分类报告**
![分类报告](./src/result/ClassReport.png)
模型对二分类任务的分类性能表现可以通过以下四个关键指标进行分析：**精确率（Precision）**、**召回率（Recall）**、**F1-Score**以及**支持度（Support）**。此外，还有宏平均（Macro Avg）和加权平均（Weighted Avg）。

#### 1. **类别 0 (非仇恨言论)**
   - **精确率（Precision）**：96.60%
   - **召回率（Recall）**：98.44%
   - **F1-Score**：97.52%
   - **支持度（Support）**：331,897

   模型在识别非仇恨言论上表现非常好，精确率、召回率和 F1-Score 都很高，表明模型能有效区分正常言论，并且很少将仇恨言论误分类为正常言论。

#### 2. **类别 1 (仇恨言论)**
   - **精确率（Precision）**：77.32%
   - **召回率（Recall）**：60.49%
   - **F1-Score**：67.88%
   - **支持度（Support）**：29,078

   对仇恨言论的识别能力相对较低，精确率为77.32%，而召回率仅为60.49%，意味着模型虽然在预测仇恨言论时较为准确，但可能漏掉了部分仇恨言论（即较低的召回率）。

#### 3. **宏平均 (Macro Avg)**
   - **精确率（Precision）**：86.96%
   - **召回率（Recall）**：79.47%
   - **F1-Score**：82.70%
   - **支持度（Support）**：360,975

   宏平均计算每个类别的指标平均值，未考虑类别的不平衡。它显示出模型对两个类别的整体表现，精确率和召回率适中，表明在处理类别不平衡时，模型的表现有一定的局限性。

#### 4. **加权平均 (Weighted Avg)**
   - **精确率（Precision）**：95.05%
   - **召回率（Recall）**：95.39%
   - **F1-Score**：95.13%
   - **支持度（Support）**：360,975

   加权平均考虑了每个类别的样本量，通过支持度对指标进行加权平均。这一结果表明模型的总体性能表现优异，特别是对大多数样本的正确分类。

### 2.**ROC**
![ROC](./src/result/ROC.png) 
   - ROC曲线越靠近左上角，模型的性能越好。结果中的曲线非常接近左上角，说明模型的分类效果非常好。
   - AUC（Area Under the Curve）值为0.9667，AUC的值介于0.5和1之间。AUC越接近1，说明模型的性能越好。0.9667是一个非常高的AUC值，表明模型具有很强的区分能力。
   - 综合来看，这张ROC曲线图表明这个分类模型的性能非常优秀。它能够很好地将正样本和负样本区分开来，具有很高的准确率和泛化能力。

## 参考
- 模型参考：[kaggle](https://www.kaggle.com/code/thousandvoices/simple-lstm/script)


## 使用说明
1. 本项目提供了完整的已训练模型，包括情感分类模型和仇恨言论检测模型。用户可通过以下链接下载并使用这些模型：
   - [点击此处下载模型（跳转至 Kaggle 下载页面）](https://www.kaggle.com/models/wenhao02/nlp)

2. 为方便用户进行测试和使用，本项目开发了一个简易的用户界面。操作步骤如下：
   - 安装项目所需的依赖库。
   - 运行 `app.py` 文件以启动本地服务器。

3. 本项目的主要目的是开发仇恨言论检测模型。然而，在界面开发阶段，由于仇恨言论检测模型尚未完全整合，项目暂时使用了情感分类模型作为替代，以方便进行接口开发和测试。如果您对情感分类模型感兴趣，可以在该[代码仓库](https://github.com/AuroraEchos/SetimentAnalysis)中找到完整的说明和使用指南。

4. 所有与仇恨言论检测相关的代码均存放于 `src` 文件夹中。
